---
layout: post
title:  "CNN卷积神经网络"
date:   2018-10-23
categories: concept
---

![](/resource/cnn/CNN_ex.png)
- - -
## 图片分类
做图片分类的时候,我们需要一个神经网络以一张图片为输入,然后输出图片对应的类型.
让我们以一辆车为例子.
![](/resource/cnn/image_classification.png)
这件事对人来说很简单,但是对一个网络呢?网络会怎么处理?

### 图片是像素的集合体
从神经网络的角度图片就是一个数字的矩阵.从下图,你可以看到放大的黑白汽车的一部分.图片由很小的小方格子组成,每个方格称为一个像素.对于黑白图片,每一个像素的值在0~255之间,0代表黑色,255代表白色.
![](/resource/cnn/grayscale_image.png)
正常的彩色图片,图片上的每个像素点都由红、绿、蓝三种像素组成.你可以把这想象成红、绿、蓝三张图片叠加到一起.你可能会看到彩色像素被表示为三个元素的数组.例如,RGB像素值,[255,0,0]是纯红色,而[200,0,200]是紫色.从这个角度,我们可以想象一下每张图片为一个3D的矩阵,有宽、高,还有深度------颜色,黑白图片的深度为1.
![](/resource/cnn/color_image.png)
要创建一个图片分类器,我们需要一个算法,可以观察这些像素并且能够识别出图片中有一辆汽车.我们也希望这个分类器能够在不同光线条件下(晚上或白天)识别汽车,这个分类器能很好的泛化,这样他才能识别出不同环境不同角度下不同的汽车.
![](/resource/cnn/var_cars.png)
如果你观察一下几张汽车的图片,你会发现每张图片的像素都差异很大.所以,这个分类器要做到能够分辨出所有差异很大的图片中有汽车存在.

### 数据导向的方法
因为没有明确的方法可以创建一组规则来确定一堆像素是一辆车子,我们将采用数据导向的方法:
> 1. 收集一组有汽车标签的图片
2. 训练一个模型准确预测图片类别

![](/resource/cnn/training_data.png)
在这个例子中,我们计划训练一个卷积神经网络(convolutional neural network).这个网络在训练中,会学到汽车的哪部分为关键特征,例如轮胎和车窗,并且它要足够泛化,这样才能识别不同角度不同环境下的汽车.
* * *

### 卷积神经网络
我们将使用卷积神经网络(CNN)来完成图片分类的任务.CNN能够发现并表示3D图片空间里的特征.很多神经网络一次只关注一个输入(处理图片的时候,一个像素),但卷积神经网络可以一次接收图片中一个区域的像素,并学会寻找空间上的特征.

每个CNN都是由多个网络层构成,主要的三种类型为卷积网络(convolutional),池化层(pooling),和全链接层(fully-connected),如下图所示.一般,你可以看到CNN由很多网络层构成,尤其是卷积层和池化层.每个层由多个节点构成,这些节点对输入数据进行相应处理.
![](/resource/cnn/CNN_ex.png)

#### 卷积层
卷积层可以理解为这个神经网络的特征 *提取器*,它被训练来寻找输入图片的空间特征.
这个网络层通过对图片一系列很多不同的图片滤镜,也即卷积核(convolutional kernels)来生成的.这些滤镜在图片上一个像素一个像素的扫描,并且生成一个差不多跟原图片一样大小的输出图片.多个卷积核会生成多个输出图片.
![](/resource/cnn/conv_layer.gif)
如果我们有四个不同的卷积核,这样就会生成四张不同的滤出图片.每个不同的滤镜会提取输入图片中不同的特征,而这些特征对最终的图片分类有帮助.例如,一个滤镜可以检测图片中物体的边缘而另一个可能可以提取色彩中独特的特征.这些滤镜,叠合到一起就是一个卷积网络层.
